const env=require("dotenv").config(),Discord=require("discord.js"),keys=require("./keys.json"),{parse:parse,pool:pool,roll:roll}=require("dicebag");let prefix=process.env.PREFIX,token=process.env.TOKEN;var logger=require("winston");const uuid=require("uuid"),projectId=keys.dialogflow_project_id,dialogflow=require("dialogflow"),dialogflowClient=new dialogflow.SessionsClient,sessionId=uuid.v4();console.log(sessionId);const sessionPath=dialogflowClient.sessionPath("proyectobot-274016",sessionId);logger.remove(logger.transports.Console),logger.add(new logger.transports.Console,{colorize:!0}),logger.level="debug";const client=new Discord.Client;client.on("ready",()=>{console.log("ready"),client.user.setActivity("Rol Cueva",{type:"PLAYING"})}),client.on("message",e=>{if(!e.author.bot){if(e.content.startsWith("Alfred")){const o={session:sessionPath,queryInput:{text:{text:e,languageCode:"es-US"}}};dialogflowClient.detectIntent(o).then(e=>{console.log("detetIntent"),m.channel.send(e[0].queryResult.fulfillmentText)})}if(e.content.startsWith(prefix)){var o=e.content.trim().split(/ +/g);if(console.log(o),o[0]==prefix){if("!Anunciar"==o[1]){var n=o[2],l=n.substr(2,18);const s=client.channels.cache.get(l);mensaje=e.content.substr(38,e.content.length-38),s.send(mensaje)}if("!Roll"==o[1]){const n=parse(o[2]);console.log(roll(n)),console.log(pool(n)),e.reply(`${pool(n)}`)}o.forEach(function(o){"?help"!=o||e.reply("Bienvenido Amo, \n \tEste es el menú de comandos de la Rol Cueva:\n 1-Bla\n2-Bleh\n3-Blih")})}else e.reply(`Amo, deberá realizar su pedido utilizando el prefijo ${prefix}`)}}}),client.login(token);